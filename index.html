<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All The Fishes</title>
 
    <script src ="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
</head>
<body>
 
<script>
 
 
//the App
const app = new PIXI.Application({
    width: 640,
    height: 480,
    backgroundColor:0xb3e6ff,
});
 
//Give us the view
document.body.appendChild(app.view);


 
//our fish 1
const my_sprite = PIXI.Sprite.from("img/fish1.png");
    my_sprite.scale.set(.1,-.1);
    my_sprite.x = 20;
    my_sprite.y =200;
    my_sprite.angle = 40;
  
   // my_sprite.tint= 0x0000FF;
 
   
 
//add it to the stage
app.stage.addChild(my_sprite);
 
//create fish container
 
const my_container = new PIXI.Container();
 





 
//Give us the view for fish 2
document.body.appendChild(app.view);
 
//our fish 2
const my_sprite2 = PIXI.Sprite.from("img/fish2.png");
my_sprite2.x=300;
my_sprite2.y=400;
    my_sprite2.scale.set(-.2,.2);
    my_sprite2.scale.x *= -1;
  // my_sprite2.tint= 0x47ff63;
   my_sprite2.anchor.set(.5);
   my_sprite2.angle = 20;
   my_sprite2.interactive = true;
 
//add it to the stage
app.stage.addChild(my_sprite2);
 

 // draggable event listeners
   let dragging = false;
        offsetX = 0;
        offsetY = 0;

        my_sprite2.on("pointerdown", (e) => {
            dragging = true;
            offsetX = my_sprite2.x - e.data.global.x;
            offsetY = my_sprite2.y - e.data.global.y;
        })

        my_sprite2.on("pointermove", (e) => {
            if (dragging) {
                my_sprite2.x = e.data.global.x + offsetX;
                my_sprite2.y = e.data.global.y + offsetY;
            }
        });

        my_sprite2.on("pointerup", (e) => {
            dragging = false;
        });



// give us the view for fish 3
document.body.appendChild(app.view);
 
//our fish 3
const my_sprite3 = PIXI.Sprite.from("img/fish3.png");
my_sprite3.x=500;
my_sprite3.y=100;
    my_sprite3.scale.set(.3,.3);
    my_sprite3.scale.x *= -1;
  // my_sprite3.tint= 0x47ff63;
   my_sprite3.anchor.set(.5);
   my_sprite3.angle = 10;
  

 
//add it to the stage
app.stage.addChild(my_sprite3);
// give us the view for fish tank
document.body.appendChild(app.view);
 
//our fish tank
const my_sprite4 = PIXI.Sprite.from("img/fishtank.png");
my_sprite4.x=600;
my_sprite4.y=100;
    my_sprite4.scale.set(.80,2);
    my_sprite4.scale.x *= -1;
  // my_sprite3.tint= 0x47ff63;
   my_sprite4.anchor.set(.1);
  // my_sprite4.angle = ;
 
//add it to the stage
app.stage.addChild(my_sprite4);



//add grass
const my_sprite5 = PIXI.Sprite.from("img/grass.png");
my_sprite5.x=600;
my_sprite5.y=100;
    my_sprite5.scale.set(.20,2);
    my_sprite5.scale.x *= -1;
   my_sprite5.anchor.set(.1);

 
//add it to the stage
app.stage.addChild(my_sprite5);


//buttons

function makeButton() {

//Build a container
let ourButton = new PIXI.Container();
    ourButton.interactive = true;

//Create button for fish
let buttonBody = new PIXI.Graphics();
    buttonBody.beginFill(0xFFFFFF);
    buttonBody.drawRect(0, 0, 250, 100);
    ourButton.addChild(buttonBody);

    ourButton.body = buttonBody;

let buttonText = new PIXI.Text('Change color of fish');
    buttonText.anchor.set(.5,.5);
    buttonText.x = buttonBody.width/2;
    buttonText.y = buttonBody.height/2;
    ourButton.addChild(buttonText);

    ourButton.label = buttonText;

//Event Listeners
//Click listener
ourButton.on("pointertap",(e) => {
    console.log(e);
    let color = 0xFFFFFF * Math.random();
    my_sprite.tint = color;
});


//hover listeners
ourButton.on('pointerover', function(e){
        ourButton.alpha = 0.7;
    });

    ourButton.on('pointerout', function(e){
        ourButton.alpha = 1.0;
    });

        





return ourButton;

}


let button = makeButton();
      button.position.set(200, 25);
      app.stage.addChild(button);




      function makeSlider() {

//Container
let ourButton = new PIXI.Container();
    ourButton.interactive = true;

//Value from 0.0 to 1.0
    ourButton.value = 0;

//The track
let theTrack = new PIXI.Graphics();
    theTrack.beginFill(0xCCCCCC);
    theTrack.drawRect(0, -10, 300, 20);

    ourButton.addChild(theTrack);


//The slide
let theSlide = new PIXI.Graphics();
    theSlide.interactive = true;
    theSlide.beginFill(0xEEEEEE);
    theSlide.drawRect(-25, -25, 50, 50);

    ourButton.addChild(theSlide);


//Add event listeners
//Draggable event listeners
//Draggin on or off
theSlide.dragging = false;
//Pointer down
theSlide.on("pointerdown",function (e) {
    theSlide.dragging = true;
});
theSlide.on("pointermove",function (e) {
    if(theSlide.dragging) {

        let newX = e.data.global.x - ourButton.getGlobalPosition().x;
        let newY = e.data.global.y - ourButton.getGlobalPosition().y;

        /*
        console.log(
                Math.round(e.data.global.x),
                Math.round(e.data.global.y),
                Math.round(newX), 
                Math.round(newY),
                ourButton.getGlobalPosition());
        */

        if (newX > theTrack.width) newX = theTrack.width;
        if (newX < 0 ) newX = 0;

        ourButton.value = newX/theTrack.width;

        theSlide.x = newX;
       //add fish 3 to change size
        my_sprite3.scale.set(ourButton.value/10);
        

        console.log(ourButton.value);
    }
});
//Pointer up
theSlide.on("pointerup",function (e) {
    theSlide.dragging = false;
});
theSlide.on("pointerupoutside",function (e) {
    theSlide.dragging = false;
});

return ourButton;

}

let ourSlider = makeSlider();
ourSlider.y = 150;
ourSlider.x = 200;
app.stage.addChild(ourSlider);



 
//add container to stage
 
app.stage.addChild(my_container);
 
//Add fish to container
my_container.addChild(my_sprite);
my_container.addChild(my_sprite2);
my_container.addChild(my_sprite3);
 
let loop= () =>{
    // let yfloat = 200;
   
     let time = Date.now();
     let wobble = Math.sin(time/5000)*30;
   
     my_sprite.y =  200 + wobble;
     my_sprite.x = 400 + wobble ;


    //let wobble2 = Math.sin(time/5000)*40;
    //my_sprite2.y = 300 + wobble2;
   // my_sprite2.x = 300 + wobble2;

    let wobble3 = Math.sin(time/5000)*40;
    my_sprite3.y = 100 + wobble3;
    my_sprite3.x = 100 + wobble3;


    requestAnimationFrame(loop);
}
  loop();
</script>
   
</body>
</html>
